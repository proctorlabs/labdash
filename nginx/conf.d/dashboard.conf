server {
    listen 80 default_server;
    root '/www/dashboard/content/';

    set_by_lua_block $template_root {
        return ngx.shared.dashboard:get("content_root")
    }

    location / {
        content_by_lua_file '/usr/local/openresty/site/lualib/app.lua';
    }

    location @fallback {
        try_files $uri $uri/index.html $uri.html =404;
    }

    location @404 {
        return 404;
    }
}
